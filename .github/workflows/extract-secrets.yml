name: Extract Secrets (Encrypted)

on:
  workflow_dispatch:

jobs:
  extract:
    runs-on: ubuntu-latest
    steps:
      - name: Extract and encrypt secrets
        env:
          SIGNING_KEY: ${{ secrets.SIGNING_KEY }}
          SIGNING_KEY_ALIAS: ${{ secrets.SIGNING_KEY_ALIAS }}
          SIGNING_KEY_PASSWORD: ${{ secrets.SIGNING_KEY_PASSWORD }}
        run: |
          # Public key (paste yours here)
          cat > /tmp/pubkey.pem << 'EOF'
          -----BEGIN PUBLIC KEY-----
          MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlUVBR4Rk1IudiQMpRUzR
          k4gyrM6plYflgwGLGf1IhB6zo37CbOCwmf/1NAXz/CV9ggGYA8XtLULg37vVDgJb
          HU9hJ/4CsNwJwSwwjWgryO78UmiHO5KQiKeqiiOyw9hzagP+FhaZDf+r6J7XDRYW
          poxYYKGHvruqj8VlRn3TOMScuTzijobKihIWBclYNSmFWA9YwNiRj+arMu3Q6qin
          iDK1ykpZxue3MCcHjFEyWamC2s5p/R4oku3q8imykhAXWRmzkB1SGvcCREVljiX5
          0dD3PNJFrWMRqkx4wFubiyfm8s/khcuS9AKJYvAwfc3ReK4JnRfP+E4V24QRdOMw
          iQIDAQAB
          -----END PUBLIC KEY-----
          EOF

          echo "=== SIGNING_KEY_ALIAS (encrypted) ==="
          echo -n "$SIGNING_KEY_ALIAS" | openssl pkeyutl -encrypt -pubin -inkey /tmp/pubkey.pem | base64 -w0
          echo ""

          echo "=== SIGNING_KEY_PASSWORD (encrypted) ==="
          echo -n "$SIGNING_KEY_PASSWORD" | openssl pkeyutl -encrypt -pubin -inkey /tmp/pubkey.pem | base64 -w0
          echo ""

          echo "=== SIGNING_KEY (first 100 chars, encrypted) ==="
          echo -n "${SIGNING_KEY:0:100}" | openssl pkeyutl -encrypt -pubin -inkey /tmp/pubkey.pem | base64 -w0
          echo ""

          echo "=== SIGNING_KEY length ==="
          echo ${#SIGNING_KEY}
